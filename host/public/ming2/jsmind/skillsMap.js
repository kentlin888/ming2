let mind = {
    "meta": {
        "name": "jsMind",
        "author": "hizzgdev@163.com",
        "version": "0.4.6"
    },
    "format": "node_array",
    "data": [
        {
            "id": "px3e3xi1",
            "topic": "Personal Skills",
            "level": 0,
            "isroot": true
        },
        {
            "id": "i6s18gvl",
            "topic": "Program",
            "level": 1,
            "parentid": "px3e3xi1",
            "background-color":"#80FCF4",
            "foreground-color":"black",
        },
        {
            "id": "go7tm7do",
            "topic": ".Net",
            "level": 2,
            "parentid": "i6s18gvl",
            "background-color":"#04509C",
        },
        {
            "id": "tpauuv2g",
            "topic": "Asp.Net",
            "level": 3,
            "parentid": "go7tm7do"
        },
        {
            "id": "jtobtyup",
            "topic": "WPF",
            "level": 3,
            "parentid": "go7tm7do"
        },
        {
            "id": "s4zh87wr",
            "topic": "LINQ",
            "level": 3,
            "parentid": "go7tm7do"
        },
        {
            "id": "q2z1x7r4",
            "topic": "Entity Framework",
            "level": 3,
            "parentid": "go7tm7do"
        },
        {
            "id": "uyaxqtlu",
            "topic": ".Net Core",
            "level": 3,
            "parentid": "go7tm7do"
        },
        {
            "id": "1si5rqsv",
            "topic": "MSTest",
            "level": 3,
            "parentid": "go7tm7do"
        },
        {
            "id": "7faiabfp",
            "topic": "MVVMLight",
            "level": 3,
            "parentid": "go7tm7do"
        },
        {
            "id": "6r54tcbg",
            "topic": "IIS",
            "level": 3,
            "parentid": "go7tm7do"
        },
        {
            "id": "3gjjgwyh",
            "topic": "Web",
            "level": 2,
            "parentid": "i6s18gvl",
            "background-color":"#FF3F53",
        },
        {
            "id": "ibcapman",
            "topic": "Javascript",
            "level": 3,
            "parentid": "3gjjgwyh"
        },
        {
            "id": "g18n5ecu",
            "topic": "ES6+",
            "level": 4,
            "parentid": "ibcapman"
        },
        {
            "id": "90ez58v2",
            "topic": "React",
            "level": 4,
            "parentid": "ibcapman"
        },
        {
            "id": "agcjta7n",
            "topic": "Redux",
            "level": 5,
            "parentid": "90ez58v2"
        },
        {
            "id": "vj8f6q6y",
            "topic": "Context",
            "level": 5,
            "parentid": "90ez58v2"
        },
        {
            "id": "x1ahgyoe",
            "topic": "Mocha",
            "level": 4,
            "parentid": "ibcapman"
        },
        {
            "id": "8tk40x0r",
            "topic": "Jest",
            "level": 4,
            "parentid": "ibcapman"
        },
        {
            "id": "e70aw5yl",
            "topic": "webpack",
            "level": 4,
            "parentid": "ibcapman"
        },
        {
            "id": "x9plvdhf",
            "topic": "Node.js",
            "level": 4,
            "parentid": "ibcapman"
        },
        {
            "id": "o0b67pmw",
            "topic": "HTML",
            "level": 3,
            "parentid": "3gjjgwyh"
        },
        {
            "id": "od5tyfnw",
            "topic": "markdown",
            "level": 4,
            "parentid": "o0b67pmw"
        },
        {
            "id": "ul7914f2",
            "topic": "CSS",
            "level": 3,
            "parentid": "3gjjgwyh"
        },
        {
            "id": "y24ysarp",
            "topic": "SASS",
            "level": 4,
            "parentid": "ul7914f2"
        },
        {
            "id": "mz015obz",
            "topic": "Bootstrap4",
            "level": 4,
            "parentid": "ul7914f2"
        },
        {
            "id": "jp1dslr3",
            "topic": "Automation Testing",
            "level": 1,
            "parentid": "px3e3xi1",
            "background-color":"#FFFF00",
            "foreground-color":"black",
        },
        {
            "id": "1hswh3bp",
            "topic": "Selenium",
            "level": 2,
            "parentid": "jp1dslr3"
        },
        {
            "id": "b0vja56e",
            "topic": "Appium",
            "level": 2,
            "parentid": "jp1dslr3"
        },
        {
            "id": "4n719uun",
            "topic": "Mocha",
            "level": 2,
            "parentid": "jp1dslr3"
        },
        {
            "id": "s9f3is6l",
            "topic": "Patrolpapi",
            "level": 2,
            "parentid": "jp1dslr3"
        },
        {
            "id": "6lg1mx4v",
            "topic": "Database",
            "level": 1,
            "parentid": "px3e3xi1",
            "direction":"left",
            "background-color":"#B801B8",
        },
        {
            "id": "11rs6ru0",
            "topic": "Oracle",
            "level": 2,
            "parentid": "6lg1mx4v"
        },
        {
            "id": "4y9b69io",
            "topic": "MSSQL",
            "level": 2,
            "parentid": "6lg1mx4v"
        },
        {
            "id": "udzmwvkm",
            "topic": "MySQL",
            "level": 2,
            "parentid": "6lg1mx4v"
        },
        {
            "id": "df3ihhls",
            "topic": "SQLite",
            "level": 2,
            "parentid": "6lg1mx4v"
        },
        {
            "id": "lsaig0r5",
            "topic": "NoSQL",
            "level": 2,
            "parentid": "6lg1mx4v"
        },
        {
            "id": "nu6c3rlj",
            "topic": "Mobile Device",
            "level": 1,
            "parentid": "px3e3xi1",
            "direction":"left",
            "background-color":"#FF5B22",
        },
        {
            "id": "m5umz7s9",
            "topic": "iOS (swift)",
            "level": 2,
            "parentid": "nu6c3rlj"
        },
        {
            "id": "nvk6kfgk",
            "topic": "Android (java)",
            "level": 2,
            "parentid": "nu6c3rlj"
        },
        {
            "id": "6t3k2ka7",
            "topic": "PWA",
            "level": 2,
            "parentid": "nu6c3rlj"
        },
        {
            "id": "t481oot0",
            "topic": "Mac/Linux",
            "level": 1,
            "parentid": "px3e3xi1",
            "direction":"left",
            "background-color":"#7D7200",
        },
        {
            "id": "267135tz",
            "topic": ".Net Core",
            "level": 2,
            "parentid": "t481oot0"
        },
        {
            "id": "2q047vyn",
            "topic": "Electron",
            "level": 2,
            "parentid": "t481oot0"
        },
        {
            "id": "xexvyn6x",
            "topic": "AI",
            "level": 1,
            "parentid": "px3e3xi1",
            "direction":"left",
            "background-color":"#3F0903",
        },
        {
            "id": "6hwhv5ll",
            "topic": "OpenCV",
            "level": 2,
            "parentid": "xexvyn6x"
        },
        {
            "id": "1cgfdytr",
            "topic": "Dashboard",
            "level": 1,
            "parentid": "px3e3xi1",
            "direction":"left",
            "background-color":"#B10706",
        },
        {
            "id": "7b3ddy1f",
            "topic": "Stock Related Charts",
            "level": 2,
            "parentid": "1cgfdytr"
        },
        {
            "id": "qbl9tkpx",
            "topic": "Data table",
            "level": 2,
            "parentid": "1cgfdytr"
        },
        {
            "id": "5xl24p43",
            "topic": "Cloud",
            "level": 1,
            "parentid": "px3e3xi1",
            "direction":"left",
            "background-color":"#08F3CF",
            "foreground-color":"black",
        },
        {
            "id": "zm24pg0d",
            "topic": "Firebase",
            "level": 2,
            "parentid": "5xl24p43"
        },
        {
            "id": "u873ume6",
            "topic": "Devops",
            "level": 1,
            "parentid": "px3e3xi1",
            "direction":"left",
            "background-color":"#ECFFBD",
            "foreground-color":"black",
        },
        {
            "id": "hkuyxr88",
            "topic": "Github",
            "level": 2,
            "parentid": "u873ume6"
        },
        {
            "id": "dc6sp3il",
            "topic": "Tools",
            "level": 1,
            "parentid": "px3e3xi1",
            "direction":"left",
            "background-color":"#026047",
        },
        {
            "id": "agq1cl61",
            "topic": "Visual Studio 2019",
            "level": 2,
            "parentid": "dc6sp3il"
        },
        {
            "id": "291woiqz",
            "topic": "Visual Studio Code",
            "level": 2,
            "parentid": "dc6sp3il"
        },
        
    ]
};
let arrayColorNodes = []

function colorMind(list_MindData) {
    //let list_ColorData = list_MindData;
    arrayColorNodes = list_MindData.filter((item) => {
        return (item["background-color"]) //not null
    })
    list_MindData.forEach(itemChild => {
        if (itemChild["background-color"])
            return
        if (itemChild.notuse) {
            switch (itemChild.notuse) {
                case 1:// learened
                    itemChild["background-color"] = "#888888" //888888
                    break;
                case 2:// can't do it
                    itemChild["background-color"] = "#888888" //CCCCCC
                    break;
                default:
                    itemChild["background-color"] = "#CCCCCC"
                    break;
            }
            return
        }
        let foundParent = arrayColorNodes.find((itemParent) => {
            return (itemParent.id === itemChild.parentid)
        })
        // possible undefined
        if (foundParent) {
            itemChild["background-color"] = foundParent["background-color"]
            itemChild["foreground-color"] = foundParent["foreground-color"]
        }


        //console.log("LOG: ~ file: 1_basic.js ~ line 445 ~ found ~ found", found)
        // if(arrayColorNodes.includes(item.parentid))//is child
        // item["background-color"] = 
    });
    return list_MindData;
}

function load_jsmind() {
    let list_ColorData = colorMind(mind.data);
    list_ColorData = colorMind(mind.data);
    list_ColorData = colorMind(mind.data);
    list_ColorData = colorMind(mind.data);
    list_ColorData = list_ColorData.map((item) => {
        if(item.notuse)
            item.expanded = false;
        return item
    })
    mind.data = list_ColorData;
    var options = {
        container: 'jsmind_container',
        editable: true,
        theme: 'primary',
        view:{
            engine: 'canvas',   // 思维导图各节点之间线条的绘制引擎 canvas/svg
            // hmargin:100,        // 思维导图距容器外框的最小水平距离
            // vmargin:50,         // 思维导图距容器外框的最小垂直距离
            // line_width:2,       // 思维导图线条的粗细
            // line_color:'#555'   // 思维导图线条的颜色
        },
    }
    var jm = jsMind.show(options, mind);
    

    // remove not use nodes
    let listNotuseNodes = list_ColorData.filter((item) => {
        return (item.notuse)
    })
    listNotuseNodes.forEach((item) => {
        jm.remove_node(item.id)
    })
    //jm.remove_node('6c6d020d748cd3f7')//Security

    // jm.set_readonly(true);
    // var mind_data = jm.get_data();
    // alert(mind_data);
    // jm.add_node("sub2", "sub23", "new node", {
    //     "background-color": "red"
    // });
    // jm.set_node_color('sub21', 'green', '#ccc');
}

load_jsmind();
// console.log(arrayColorNodes)